Hereâ€™s a Perl script that reads the **CSV file** generated by your Python script, processes the classification scores and cosine similarity values, and calculates a combined, easy-to-understand score for each document.

The script will output a new CSV file with the additional scores and helpful metrics.

---

### **Perl Script: `process_csv_scores.pl`**

```perl
#!/usr/bin/perl
use strict;
use warnings;
use Text::CSV;

# Input and output file names
my $input_file  = "classification_results_with_similarity.csv";
my $output_file = "processed_document_scores.csv";

# Open input file for reading
open my $in_fh, "<", $input_file or die "Could not open '$input_file': $!";
my $csv_in = Text::CSV->new({ binary => 1 }) or die "Cannot use CSV: " . Text::CSV->error_diag();
$csv_in->getline($in_fh); # Skip the header row

# Open output file for writing
open my $out_fh, ">", $output_file or die "Could not open '$output_file': $!";
my $csv_out = Text::CSV->new({ binary => 1, eol => $/ });

# Write new header to output CSV
$csv_out->print($out_fh, ["File Name", "Label", "Score", "Cosine Similarity", "Combined Score", "Interpretation"]);

# Process each row in the input CSV
while (my $row = $csv_in->getline($in_fh)) {
    my ($file_name, $label, $score, $cosine_similarity) = @$row;

    # Calculate a combined score: weighted average of classification score and cosine similarity
    my $combined_score = (0.7 * $score) + (0.3 * $cosine_similarity);

    # Interpret the combined score
    my $interpretation;
    if ($combined_score >= 0.8) {
        $interpretation = "Highly Relevant";
    } elsif ($combined_score >= 0.5) {
        $interpretation = "Moderately Relevant";
    } else {
        $interpretation = "Less Relevant";
    }

    # Write the row to the output file
    $csv_out->print($out_fh, [$file_name, $label, $score, $cosine_similarity, sprintf("%.4f", $combined_score), $interpretation]);
}

# Close file handles
close $in_fh or die "Could not close '$input_file': $!";
close $out_fh or die "Could not close '$output_file': $!";

print "Processing complete. Output saved to '$output_file'.\n";
```

---

### **What This Script Does**

1. **Reads the Input CSV**:
   - Assumes the CSV contains columns: `File Name`, `Label`, `Score`, and `Cosine Similarity`.

2. **Calculates a Combined Score**:
   - Combines the **classification score** and **cosine similarity** using a weighted average:
     - 70% weight to the classification score.
     - 30% weight to the cosine similarity.
   - The weights can be adjusted based on your use case.

3. **Generates an Interpretation**:
   - Adds an easy-to-understand interpretation based on the combined score:
     - **Highly Relevant**: `>= 0.8`
     - **Moderately Relevant**: `>= 0.5 and < 0.8`
     - **Less Relevant**: `< 0.5`

4. **Writes a New CSV**:
   - Outputs the processed data to a new file (`processed_document_scores.csv`) with the following columns:
     - File Name
     - Label
     - Score
     - Cosine Similarity
     - Combined Score
     - Interpretation

---

### **Example Input**

**`classification_results_with_similarity.csv`**
```csv
File Name,Label,Score,Cosine Similarity
example1.txt,science,0.8943,0.9123
example1.txt,technology,0.7321,0.8412
example2.txt,law,0.8712,0.8123
example2.txt,biology,0.4512,0.7641
```

---

### **Example Output**

**`processed_document_scores.csv`**
```csv
File Name,Label,Score,Cosine Similarity,Combined Score,Interpretation
example1.txt,science,0.8943,0.9123,0.8990,Highly Relevant
example1.txt,technology,0.7321,0.8412,0.7637,Moderately Relevant
example2.txt,law,0.8712,0.8123,0.8572,Highly Relevant
example2.txt,biology,0.4512,0.7641,0.5560,Moderately Relevant
```

---

### **How to Use the Script**

1. **Save the Script**:
   Save the script as `process_csv_scores.pl`.

2. **Install Required Perl Module**:
   If `Text::CSV` is not already installed, you can install it via CPAN:
   ```bash
   cpan Text::CSV
   ```

3. **Run the Script**:
   ```bash
   perl process_csv_scores.pl
   ```

4. **Check the Output**:
   - The output will be saved as `processed_document_scores.csv` in the same directory.

---

### **Customizing the Script**
- **Adjust Weights**: Modify the `0.7` and `0.3` in the `combined_score` calculation to prioritize classification or similarity.
- **Change Interpretation Thresholds**: Update the ranges for "Highly Relevant," "Moderately Relevant," and "Less Relevant" as needed.

Let me know if you need additional features or refinements! ðŸ˜Š
